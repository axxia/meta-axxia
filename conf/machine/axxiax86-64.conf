#@TYPE: Machine
#@NAME: axxiax86-64
#@DESCRIPTION: Machine configuration for INTEL Axxia x86_64 systems (Intel Core i7 CPU and later) with MMX, SSE, SSE2, SSE3, and SSSE3 instruction set support. Supports a moderately wide range of drivers that should boot and be usable on "typical" hardware.

PREFERRED_VERSION_linux-yocto ?= "4.9%"
PREFERRED_PROVIDER_virtual/kernel ?= "linux-yocto"

require conf/machine/intel-corei7-64.conf

MACHINEOVERRIDES =. "intel-x86-common:"

MACHINE_FEATURES += "ext3"

KARCH = "x86_64"
KERNEL_IMAGETYPE = "bzImage"
KEEPUIMAGE = "no"

APPEND += "intel_iommu=on"

IMAGE_FSTYPES += "hddimg"
IMAGE_FSTYPES += "ext2"
IMAGE_FSTYPES += "tar.gz"

MACHINE_ESSENTIAL_EXTRA_RDEPENDS += "kernel-module-simicsfs"
KERNEL_MODULE_AUTOLOAD += " simicsfs"
IMAGE_INSTALL_append = " simicsfs-mod"

# For axxia kernels skip bbappends from meta-virtualization and meta-intel to skip fragments and layer specific setings for kernel
BBMASK = "meta-virtualization/recipes-kernel/linux"
BBMASK .= "|meta-intel/common/recipes-kernel/linux"
